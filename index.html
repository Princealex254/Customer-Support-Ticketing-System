<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prince Alex Digital - Customer Support</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* Basic Reset & Typography */
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.4s ease, color 0.4s ease;
        }

        /* CSS Variables for Light/Dark Mode */
        :root {
            --primary-color: #0077CC; /* Royal Blue / Digital Blue */
            --secondary-color: #F4F7FA; /* Light Grey for page background */
            --accent-color: #FF8800; /* Bright Orange for attention/action */
            
            --bg-color: var(--secondary-color); 
            --card-bg: #FFFFFF; /* White for card backgrounds */
            --border-color: #E0E4E8; /* Slightly darker grey for borders */
            --text-color: #212529; /* Dark text for readability */
            --heading-color: #333333; /* Darker text for headings */
            --muted-text-color: #6c757d; /* Lighter text for descriptions/notes */
            
            --customer-bubble-bg: #E0F2F7; /* Light blue */
            --admin-bubble-bg: #F0F0F0;   /* Light grey */

            --shadow-light: 0 4px 12px rgba(0,0,0,0.08); /* Soft shadow for cards */
            --shadow-button: 0 2px 6px rgba(0,0,0,0.1); /* Button specific shadow */
        }

        body.dark-mode {
            --primary-color: #5AA9E6; /* Lighter blue for dark mode contrast */
            --secondary-color: #2C3E50; /* Dark grey for page background in dark mode */
            --accent-color: #FFAA44; /* Slightly brighter orange for dark mode */

            --bg-color: var(--secondary-color); 
            --card-bg: #34495E; /* Darker grey for card backgrounds */
            --border-color: #4A6078; /* Muted border in dark mode */
            --text-color: #ECF0F1; /* Light text for readability */
            --heading-color: #F8F9FA; /* Lighter text for headings */
            --muted-text-color: #BDC3C7; /* Muted text in dark mode */
            
            --customer-bubble-bg: #4A6078; /* Darker blue */
            --admin-bubble-bg: #5D728A;   /* Darker grey */

            --shadow-light: 0 4px 12px rgba(0,0,0,0.3); 
            --shadow-button: 0 2px 6px rgba(0,0,0,0.2);
        }

        /* Header & Navigation */
        header {
            background-color: var(--card-bg);
            box-shadow: var(--shadow-light);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-color);
            text-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .nav-links {
            list-style: none;
            display: flex;
            gap: 2rem;
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text-color);
            font-weight: 400;
            padding-bottom: 0.25rem;
            transition: color 0.3s ease, border-bottom 0.3s ease;
        }

        .nav-links a.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            font-weight: 700;
        }

        .nav-links a:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        #theme-toggle {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.7rem;
            padding: 0;
            color: var(--text-color);
            transition: transform 0.2s ease;
        }
        #theme-toggle:hover {
            transform: scale(1.1);
        }

        /* Hamburger menu for mobile */
        .hamburger {
            display: none; /* Hidden by default */
            cursor: pointer;
            font-size: 2.2rem;
            color: var(--text-color);
            padding: 0.5rem;
            line-height: 1; /* Adjust to center vertically */
        }

        /* Tagline below header */
        .tagline {
            text-align: center;
            padding: 0.75rem 0;
            background-color: var(--bg-color);
            color: var(--muted-text-color);
            font-size: 0.95rem;
            border-top: 1px solid var(--border-color);
        }

        /* Main Content & Sections */
        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        section {
            display: none;
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        section.active {
            display: block;
        }

        .container {
            padding: 2.5rem;
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow-light);
        }

        h1, h2 {
            color: var(--heading-color);
            border-bottom: 1px solid var(--border-color); /* Thinner border */
            padding-bottom: 1rem;
            margin-top: 0;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        /* Dashboard Cards */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .card {
            padding: 1.8rem;
            border-radius: 10px;
            background-color: var(--bg-color);
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.12);
        }

        .card h3 {
            margin: 0 0 0.7rem;
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .card p {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 0;
            color: var(--heading-color);
        }

        /* Forms */
        form {
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        label {
            font-weight: 700;
            color: var(--heading-color);
            margin-bottom: -0.5rem; /* Pull label closer to input */
            display: block;
        }

        input[type="text"], input[type="file"], input[type="email"], select, textarea {
            padding: 0.85rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--card-bg); /* Use card background for inputs */
            color: var(--text-color);
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        input[type="text"]:focus, input[type="file"]:focus, input[type="email"]:focus, select:focus, textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0,119,204,0.2); /* Focus ring effect */
        }
        input::placeholder, textarea::placeholder {
            color: var(--muted-text-color);
            opacity: 0.7;
        }


        button {
            padding: 0.9rem 1.8rem;
            background: linear-gradient(145deg, var(--primary-color), #0056b3); /* Darker blue for gradient end */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: var(--shadow-button);
            transition: all 0.2s ease;
            outline: none;
        }

        button:hover {
            background: linear-gradient(145deg, #0056b3, var(--primary-color)); /* Reverse gradient on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Ticket Lists & Details */
        .ticket-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .ticket-search-bar {
            margin-bottom: 1.5rem;
            padding: 0.85rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--card-bg);
            color: var(--text-color);
            width: 100%;
            box-sizing: border-box; 
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .ticket-search-bar:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0,119,204,0.2);
        }

        .ticket-item {
            padding: 1.2rem 1.5rem;
            background-color: var(--bg-color); /* Use secondary background for list items */
            border-radius: 10px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }

        .ticket-item:hover {
            background-color: #EBF2F7; /* Lighter shade of secondary color */
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        body.dark-mode .ticket-item:hover {
            background-color: #3B536B;
        }


        .ticket-item h4 {
            margin: 0;
            color: var(--heading-color);
            font-size: 1.1rem;
        }

        .ticket-item p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--muted-text-color);
        }

        .status-badge {
            padding: 0.3rem 0.7rem;
            border-radius: 16px;
            font-size: 0.8rem;
            color: white;
            font-weight: 700;
            display: inline-block;
            margin-top: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .status-badge.pending { background-color: var(--accent-color); } 
        .status-badge.in-progress { background-color: #17a2b8; } /* Keep existing blue-green for in-progress */
        .status-badge.resolved { background-color: #28a745; } /* Keep existing green for resolved */

        .ticket-detail-card {
            padding: 2.5rem;
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow-light);
        }

        .ticket-detail-card h3 {
            margin-top: 0;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .ticket-detail-card .ticket-info p {
            margin-bottom: 0.6rem;
            font-size: 1rem;
            color: var(--text-color);
        }
        .ticket-detail-card .ticket-info strong {
            color: var(--heading-color);
        }

        .ticket-detail-card .updates {
            border-top: 1px solid var(--border-color);
            padding-top: 1.5rem;
            margin-top: 2rem;
        }

        .updates-list {
            max-height: 350px; /* Slightly taller for more messages */
            overflow-y: auto;
            padding-right: 15px; /* More space for scrollbar */
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .update-item {
            padding: 0.9rem 1.2rem;
            border-radius: 18px; /* More rounded bubbles */
            margin-bottom: 0.2rem; /* Reduce gap between bubbles */
            max-width: 85%; /* Slightly wider bubbles */
            clear: both; 
            word-wrap: break-word; 
            box-shadow: 0 1px 4px rgba(0,0,0,0.05); /* Subtle bubble shadow */
        }

        .update-item.customer-reply {
            background-color: var(--primary-color); /* Primary color for customer */
            color: white;
            float: right;
            border-bottom-right-radius: 6px;
            text-align: right;
        }

        .update-item.admin-reply {
            background-color: var(--admin-bubble-bg);
            color: var(--text-color);
            float: left;
            border-bottom-left-radius: 6px;
            text-align: left;
        }
        .update-item small {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.7); /* Lighter text for date in primary bubble */
            display: block;
            margin-top: 0.4rem;
        }
        .update-item.admin-reply small {
            color: var(--muted-text-color);
        }
        .update-item p {
            font-size: 0.95rem;
            margin: 0;
        }
        
        /* Clearfix for bubbles */
        .updates-list::after {
            content: "";
            display: table;
            clear: both;
        }
        .ticket-detail-card .add-updates {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }


        /* FAQs */
        .faq-list {
            margin-top: 1.5rem;
        }
        .faq-item {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 0.8rem;
            overflow: hidden; /* Hide overflowing content during collapse */
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            transition: box-shadow 0.2s ease;
        }
        .faq-item:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }

        .faq-question {
            padding: 1.2rem 1.5rem;
            font-weight: 700;
            color: var(--heading-color);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            background-color: var(--card-bg); /* Question part uses card background */
            border-bottom: 1px solid transparent; /* for active state */
        }

        .faq-answer {
            padding: 0 1.5rem 1.2rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, padding 0.4s ease-out, border-top 0.4s ease;
            border-top: 1px solid transparent; 
            color: var(--text-color);
        }

        .faq-item.active .faq-answer {
            max-height: 200px; /* Adjust as needed */
            padding-top: 1.2rem;
            border-top: 1px solid var(--border-color);
        }

        .faq-question::after {
            content: '▼';
            transition: transform 0.3s ease;
            font-size: 0.8em;
            color: var(--primary-color);
        }

        .faq-item.active .faq-question::after {
            transform: rotate(180deg);
        }

        /* Contact Us */
        .contact-info p {
            margin-bottom: 0.8rem;
            font-size: 1rem;
        }
        .contact-info strong {
            color: var(--heading-color);
        }
        .contact-info a {
            color: var(--primary-color);
            text-decoration: none;
            transition: text-decoration 0.2s ease;
        }
        .contact-info a:hover {
            text-decoration: underline;
        }
        #contact-form-message {
            margin-top: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 1.8rem;
            margin-top: 3rem;
            background-color: var(--card-bg);
            box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
            color: var(--muted-text-color); /* Using muted text color for footer */
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
        }

        footer a {
            color: var(--primary-color); /* Use primary color for footer links */
            text-decoration: none;
            margin: 0 0.6rem;
            transition: text-decoration 0.2s ease;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Loading Spinner */
        .spinner-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* Slightly darker overlay */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
            pointer-events: none; /* Allows clicks to pass through when hidden */
        }

        .spinner-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .spinner {
            border: 8px solid rgba(255, 255, 255, 0.2); /* Lighter border for spinner background */
            border-top: 8px solid var(--primary-color); /* Spinner color */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            box-shadow: 0 0 15px rgba(0,119,204,0.5); /* Glowing effect */
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Success Message Overlay */
        .success-message-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Semi-transparent overlay */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2001; /* Above spinner */
            opacity: 0;
            visibility: hidden; /* Hidden by default */
            transition: opacity 0.4s ease-in-out, visibility 0.4s ease-in-out;
        }

        .success-message-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .success-message-content {
            background-color: var(--card-bg);
            padding: 2.5rem 3rem;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            text-align: center;
            transform: translateY(-20px); /* Start slightly above center */
            opacity: 0;
            transition: transform 0.4s ease-out, opacity 0.4s ease-out;
        }

        .success-message-overlay.visible .success-message-content {
            transform: translateY(0); /* Move to center */
            opacity: 1;
        }

        .success-message-content svg, .success-message-content .checkmark {
            width: 60px;
            height: 60px;
            color: #28a745; /* Green for success */
            margin-bottom: 1.5rem;
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Bouncy animation */
        }
        /* For unicode checkmark if SVG not used */
        .success-message-content .checkmark {
            font-size: 4rem;
            line-height: 1;
            display: block;
            margin: 0 auto 1.5rem;
        }


        .success-message-content h3 {
            color: var(--heading-color);
            font-size: 1.8rem;
            margin-bottom: 0.8rem;
            font-weight: 700;
        }

        .success-message-content p {
            color: var(--text-color);
            font-size: 1.1rem;
            margin-bottom: 0;
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            nav {
                padding: 0.8rem 1rem; /* Adjust padding for smaller screens */
            }
            .hamburger {
                display: block; 
                order: 2; 
                margin-left: 1rem; /* Space between toggle and hamburger */
            }
            #theme-toggle {
                order: 1; 
                margin-right: auto; /* Push logo to left, hamburger to right */
            }
            .logo {
                flex-grow: 1; /* Allow logo to take available space */
                text-align: center; /* Center logo when hamburger is present */
                margin: 0;
                font-size: 1.4rem;
            }

            .nav-links {
                display: none; 
                flex-direction: column;
                width: 100%;
                text-align: center;
                padding: 0.5rem 0;
                background-color: var(--card-bg); 
                box-shadow: var(--shadow-light);
                position: absolute;
                top: 100%; 
                left: 0;
                z-index: 999;
                border-radius: 0 0 12px 12px; 
                gap: 0; /* Remove gap when stacked */
                border-top: 1px solid var(--border-color);
            }
            .nav-links.active {
                display: flex; 
            }
            .nav-links li {
                width: 100%;
                border-bottom: 1px solid var(--border-color); /* Separator for menu items */
            }
            .nav-links li:last-child {
                border-bottom: none;
            }
            .nav-links a {
                padding: 1rem 0;
                display: block;
                border-bottom: none; 
            }
            .nav-links a.active {
                border-bottom: none; 
            }

            main {
                margin: 1.5rem auto;
                padding: 0 0.8rem;
            }
            .container {
                padding: 1.5rem;
            }
            h1, h2 {
                font-size: 1.6rem;
                padding-bottom: 0.8rem;
                margin-bottom: 1rem;
            }
            .summary-cards {
                grid-template-columns: 1fr;
            }
            .card {
                padding: 1.2rem;
            }
            .card p {
                font-size: 2.2rem;
            }
            form {
                gap: 0.8rem;
            }
            label, input, select, textarea, button {
                font-size: 0.95rem;
                padding: 0.7rem;
            }
            button {
                padding: 0.8rem 1.5rem;
            }
            .ticket-item {
                padding: 1rem;
            }
            .ticket-item h4 {
                font-size: 1rem;
            }
            .ticket-item p {
                font-size: 0.85rem;
            }
            .ticket-detail-card {
                padding: 1.5rem;
            }
            .updates-list {
                padding-right: 5px;
            }
            .update-item {
                max-width: 100%; /* Allow bubbles to take full width */
                padding: 0.7rem 1rem;
                font-size: 0.9rem;
            }
            .faq-question {
                padding: 1rem 1.2rem;
                font-size: 1rem;
            }
            .faq-answer {
                padding: 0 1.2rem 1rem;
            }
            footer {
                padding: 1.2rem;
                margin-top: 2rem;
            }
            .tagline {
                font-size: 0.85rem;
            }

            .success-message-content {
                padding: 1.5rem 2rem;
            }
            .success-message-content svg, .success-message-content .checkmark {
                width: 50px;
                height: 50px;
                margin-bottom: 1rem;
            }
            .success-message-content h3 {
                font-size: 1.4rem;
            }
            .success-message-content p {
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>

    <header>
        <nav>
            <div class="logo">Prince Alex Digital – Customer Support</div>
            <button id="theme-toggle">☀️</button>
            <div class="hamburger" id="hamburger-menu">☰</div>
            <ul class="nav-links" id="nav-links">
                <li><a href="#" data-section="home" class="active">Home</a></li>
                <li><a href="#" data-section="submit-ticket">Submit Ticket</a></li>
                <li><a href="#" data-section="my-tickets">My Tickets</a></li>
                <li><a href="#" data-section="faqs">FAQs / Knowledge Base</a></li>
                <li><a href="#" data-section="contact-us">Contact Us</a></li>
            </ul>
        </nav>
        <div class="tagline">
            Submit and track your support requests easily.
        </div>
    </header>

    <main>
        <section id="home" class="active">
            <div class="container">
                <h1 id="welcome-message">Prince Alex Digital - Support Ticketing System (Demo)</h1>
                <p>Welcome to our web-based support system. Submit a ticket or view the dashboard below.</p>
                <div class="summary-cards">
                    <div class="card">
                        <h3>Total Tickets Submitted</h3>
                        <p id="total-tickets">0</p>
                    </div>
                    <div class="card">
                        <h3>Pending Tickets</h3>
                        <p id="pending-tickets">0</p>
                    </div>
                    <div class="card">
                        <h3>In Progress</h3>
                        <p id="in-progress-tickets">0</p>
                    </div>
                    <div class="card">
                        <h3>Resolved Tickets</h3>
                        <p id="resolved-tickets">0</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="submit-ticket">
            <div class="container">
                <h2>Submit a New Ticket</h2>
                <form id="ticket-form">
                    <label for="customer-name">Your Name</label>
                    <input type="text" id="customer-name" name="customer-name" required>

                    <label for="subject">Subject</label>
                    <input type="text" id="subject" name="subject" required>

                    <label for="category">Category</label>
                    <select id="category" name="category" required>
                        <option value="General">General</option>
                        <option value="Technical">Technical</option>
                        <option value="Billing">Billing</option>
                        <option value="Other">Other</option>
                    </select>

                    <label for="description">Description</label>
                    <textarea id="description" name="description" rows="5" required></textarea>

                    <label for="attachment">Attachment (optional)</label>
                    <input type="file" id="attachment-file" name="attachment" accept="image/png, image/jpeg, image/gif">
                    <p style="font-size: 0.8em; color: var(--muted-text-color);">
                        Note: This demo stores only the file name. Actual file content is not uploaded or saved.
                    </p>

                    <button type="submit">Submit Ticket</button>
                </form>
            </div>
        </section>

        <section id="my-tickets">
            <div class="container">
                <h2>My Tickets</h2>
                <input type="text" id="my-tickets-search" class="ticket-search-bar" placeholder="Search by ID, Subject, or Status...">
                <div id="my-tickets-list" class="ticket-list"></div>
            </div>
        </section>

        <section id="ticket-details">
            <div class="container">
                <button id="back-button">← Back to My Tickets</button>
                <div id="ticket-detail-view" class="ticket-detail-card"></div>
            </div>
        </section>

        <section id="faqs">
            <div class="container">
                <h2>FAQs / Knowledge Base</h2>
                <div class="faq-list">
                    <div class="faq-item">
                        <div class="faq-question">How do I reset my password?</div>
                        <div class="faq-answer">
                            <p>To reset your password, please navigate to the login page and click on the "Forgot Password" link. Follow the instructions sent to your registered email address.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">What are your support hours?</div>
                        <div class="faq-answer">
                            <p>Our support team is available Monday to Friday, 9:00 AM to 5:00 PM EAT. Tickets submitted outside these hours will be addressed on the next business day.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">Can I update my ticket after submitting it?</div>
                        <div class="faq-answer">
                            <p>Yes, you can add replies to your ticket from the "My Tickets" section by clicking on your ticket and using the reply box at the bottom of the details view. This will add an update visible to our support team.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">What categories should I choose for my ticket?</div>
                        <div class="faq-answer">
                            <p>Choose "Billing" for payment or invoice related issues, "Technical" for software or service functionality problems, "General" for inquiries not fitting other categories, and "Other" if none of the above apply.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact-us">
            <div class="container">
                <h2>Contact Us</h2>
                <div class="contact-info">
                    <p>For general inquiries not related to an existing ticket, please use the contact information below:</p>
                    <p><strong>Email:</strong> <a href="mailto:princealexdigital@gmail.com">princealexdigital@gmail.com</a></p>
                    <p><strong>Phone:</strong> <a href="tel:+254717384875">0717384875</a></p>
                    <p><strong>Website:</strong> <a href="http://www.princealex.pro" target="_blank">www.princealex.pro</a></p>
                </div>

                <h3>Send us a message:</h3>
                <form id="contact-inquiry-form">
                    <label for="inquiry-name">Your Name</label>
                    <input type="text" id="inquiry-name" required>
                    <label for="inquiry-email">Your Email</label>
                    <input type="email" id="inquiry-email" required>
                    <label for="inquiry-message">Your Message</label>
                    <textarea id="inquiry-message" rows="5" required></textarea>
                    <button type="submit">Send Message</button>
                </form>
            </div>
        </section>

    </main>

    <footer>
        © Prince Alex Digital – 2025
        <div>
            <a href="#">Privacy Policy</a> |
            <a href="#">Terms of Service</a> |
            <a href="#">Help</a>
        </div>
    </footer>

    <!-- Loading Spinner Overlay -->
    <div class="spinner-overlay" id="loading-spinner-overlay">
        <div class="spinner"></div>
    </div>

    <!-- Success Message Overlay -->
    <div class="success-message-overlay" id="success-message-overlay">
        <div class="success-message-content">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M9.707 18.293a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L9 15.586l7.293-7.293a1 1 0 011.414 1.414l-8 8z" />
            </svg>
            <h3 id="success-message-title">Success!</h3>
            <p id="success-message-text">Your action was completed successfully.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Element References
            const navLinks = document.querySelectorAll('.nav-links a');
            const sections = document.querySelectorAll('main section');
            const ticketForm = document.getElementById('ticket-form');
            const myTicketsList = document.getElementById('my-tickets-list');
            const ticketDetailView = document.getElementById('ticket-detail-view');
            const backButton = document.getElementById('back-button');
            const themeToggle = document.getElementById('theme-toggle');
            const myTicketsSearch = document.getElementById('my-tickets-search');
            const faqQuestions = document.querySelectorAll('.faq-question');
            const contactInquiryForm = document.getElementById('contact-inquiry-form');
            const hamburgerMenu = document.getElementById('hamburger-menu');
            const navMenu = document.getElementById('nav-links');
            const loadingSpinnerOverlay = document.getElementById('loading-spinner-overlay');
            const successMessageOverlay = document.getElementById('success-message-overlay');
            const successMessageTitle = document.getElementById('success-message-title');
            const successMessageText = document.getElementById('success-message-text');


            let currentTickets = [];
            let lastCustomerName = localStorage.getItem('lastCustomerName') || 'Customer';

            // --- Utility Functions ---

            /** Shows the loading spinner. */
            const showSpinner = () => {
                loadingSpinnerOverlay.classList.add('visible');
            };

            /** Hides the loading spinner. */
            const hideSpinner = () => {
                loadingSpinnerOverlay.classList.remove('visible');
            };

            /** Shows a success message. */
            const showSuccessMessage = (title, message) => {
                successMessageTitle.textContent = title;
                successMessageText.textContent = message;
                successMessageOverlay.classList.add('visible');
                setTimeout(() => {
                    successMessageOverlay.classList.remove('visible');
                }, 3000); // Message visible for 3 seconds
            };

            /** Fetches tickets from Local Storage or returns an empty array. */
            const getTickets = () => {
                const tickets = localStorage.getItem('tickets');
                return tickets ? JSON.parse(tickets) : [];
            };

            /** Saves the current tickets array to Local Storage. */
            const saveTickets = () => {
                localStorage.setItem('tickets', JSON.stringify(currentTickets));
            };

            /** Generates a unique ticket ID. */
            const generateTicketId = () => {
                const existingTickets = getTickets();
                const lastId = existingTickets.length > 0 ? existingTickets.at(-1).id : 'TKT-1000';
                const lastNumber = parseInt(lastId.split('-')[1]);
                return `TKT-${lastNumber + 1}`;
            };

            // --- UI State Management ---

            /** Switches the active section based on the data-section attribute. */
            const showSection = (id) => {
                sections.forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(id).classList.add('active');

                // Update active nav link
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-section') === id) {
                        link.classList.add('active');
                    }
                });

                // Close hamburger menu if open
                if (navMenu.classList.contains('active')) {
                    navMenu.classList.remove('active');
                }

                // Trigger functions to update content
                if (id === 'home') updateDashboard();
                if (id === 'my-tickets') renderMyTickets();
            };

            // --- Dashboard ---

            const updateDashboard = () => {
                currentTickets = getTickets();
                // Filter tickets by the last known customer name for personalized counts
                const customerTickets = currentTickets.filter(t => 
                    (t.customerName && t.customerName.toLowerCase() === lastCustomerName.toLowerCase())
                );

                const pending = customerTickets.filter(t => t.status === 'Pending').length;
                const inProgress = customerTickets.filter(t => t.status === 'In Progress').length;
                const resolved = customerTickets.filter(t => t.status === 'Resolved').length;

                document.getElementById('total-tickets').textContent = customerTickets.length;
                document.getElementById('pending-tickets').textContent = pending;
                document.getElementById('in-progress-tickets').textContent = inProgress;
                document.getElementById('resolved-tickets').textContent = resolved;

                document.getElementById('welcome-message').textContent = `Welcome, ${lastCustomerName} - Support Ticketing System (Demo)`;
            };

            // --- Submit Ticket ---

            const handleSubmitTicket = async (e) => {
                e.preventDefault();
                showSpinner(); // Show spinner on form submission

                await new Promise(resolve => setTimeout(resolve, 500)); // Simulate network delay

                const customerNameInput = document.getElementById('customer-name');
                const attachmentFileInput = document.getElementById('attachment-file');

                lastCustomerName = customerNameInput.value.trim();
                localStorage.setItem('lastCustomerName', lastCustomerName); // Save for personalized welcome

                const attachmentFileName = attachmentFileInput.files.length > 0 ? attachmentFileInput.files[0].name : 'No attachment';

                const newTicket = {
                    id: generateTicketId(),
                    customerName: lastCustomerName,
                    subject: document.getElementById('subject').value,
                    description: document.getElementById('description').value,
                    category: document.getElementById('category').value,
                    attachment: attachmentFileName, 
                    status: 'Pending',
                    date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
                    updates: [{ 
                        type: 'customer_initial', 
                        text: document.getElementById('description').value, 
                        date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
                    }]
                };
                currentTickets.push(newTicket);
                saveTickets();
                showSuccessMessage('Ticket Submitted!', `Your ticket ${newTicket.id} has been submitted successfully.`);
                ticketForm.reset();
                customerNameInput.value = lastCustomerName; // Keep the last entered name for convenience
                updateDashboard();
                hideSpinner(); // Hide spinner after submission
            };

            // --- My Tickets (Customer) ---

            const renderMyTickets = () => {
                showSpinner(); // Show spinner before rendering
                currentTickets = getTickets();
                myTicketsList.innerHTML = '';
                const searchTerm = myTicketsSearch.value.toLowerCase();

                const filteredTickets = currentTickets.filter(ticket => 
                    (ticket.customerName && ticket.customerName.toLowerCase() === lastCustomerName.toLowerCase()) && // Only show tickets by current "customer"
                    (ticket.id.toLowerCase().includes(searchTerm) ||
                    ticket.subject.toLowerCase().includes(searchTerm) ||
                    ticket.status.toLowerCase().includes(searchTerm))
                ).sort((a,b) => b.id.localeCompare(a.id)); // Sort by ID descending

                if (filteredTickets.length === 0) {
                    myTicketsList.innerHTML = '<p>No tickets found matching your criteria. Please submit one!</p>';
                    hideSpinner();
                    return;
                }

                filteredTickets.forEach(ticket => {
                    const ticketItem = document.createElement('div');
                    ticketItem.className = 'ticket-item';
                    ticketItem.innerHTML = `
                        <h4>${ticket.id}: ${ticket.subject}</h4>
                        <p>Category: ${ticket.category}</p>
                        <p>Status: <span class="status-badge ${ticket.status.toLowerCase().replace(' ', '-')}">${ticket.status}</span></p>
                        <p>Created Date: ${ticket.date}</p>
                    `;
                    ticketItem.addEventListener('click', () => renderTicketDetails(ticket.id));
                    myTicketsList.appendChild(ticketItem);
                });
                hideSpinner(); // Hide spinner after rendering
            };

            // --- Ticket Details (Customer View Only) ---

            const renderTicketDetails = async (id) => {
                showSpinner(); // Show spinner before loading details
                await new Promise(resolve => setTimeout(resolve, 300)); // Simulate network delay

                const ticket = currentTickets.find(t => t.id === id);
                if (!ticket) {
                    showSection('my-tickets');
                    hideSpinner();
                    return;
                }

                ticketDetailView.innerHTML = `
                    <button id="detail-back-button" onclick="showSection('my-tickets')">← Back to My Tickets</button>
                    <h2>Ticket Details - ${ticket.id}</h2>
                    <div class="ticket-info">
                        <p><strong>Customer Name:</strong> ${ticket.customerName || 'N/A'}</p>
                        <p><strong>Subject:</strong> ${ticket.subject}</p>
                        <p><strong>Category:</strong> ${ticket.category}</p>
                        <p><strong>Status:</strong> <span class="status-badge ${ticket.status.toLowerCase().replace(' ', '-')}">${ticket.status}</span></p>
                        <p><strong>Created Date:</strong> ${ticket.date}</p>
                        <p><strong>Attachment:</strong> ${ticket.attachment || 'None'}</p>
                    </div>
                    
                    <div class="updates">
                        <h3>Conversation History</h3>
                        <div class="updates-list">
                            ${ticket.updates.map(update => {
                                const isCustomer = update.type === 'customer_initial' || update.type === 'customer_reply';
                                return `
                                    <div class="update-item ${isCustomer ? 'customer-reply' : 'admin-reply'}">
                                        <p><strong>${isCustomer ? (update.type === 'customer_initial' ? 'Initial Description' : 'You') : 'Admin'}:</strong> ${update.text}</p>
                                        <small>${update.date}</small>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <div class="add-updates">
                        <h3>Add a Reply</h3>
                        <form id="update-form">
                            <label for="update-text">Your Message</label>
                            <textarea id="update-text" rows="3" required></textarea>
                            <button type="submit">Send Reply</button>
                        </form>
                    </div>
                `;

                const updateForm = document.getElementById('update-form');
                if (updateForm) {
                    updateForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        showSpinner(); // Show spinner on reply submission
                        await new Promise(resolve => setTimeout(resolve, 500)); // Simulate network delay

                        const updateText = document.getElementById('update-text').value;

                        ticket.updates.push({
                            type: 'customer_reply', // Always customer reply from this view
                            text: updateText,
                            date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
                        });

                        saveTickets();
                        renderTicketDetails(id); // Re-render to show the new update
                        showSuccessMessage('Reply Sent!', `Your reply has been added to ticket ${ticket.id}.`);
                        hideSpinner(); // Hide spinner after reply
                    });
                }

                showSection('ticket-details');
                hideSpinner(); // Hide spinner after rendering
            };

            // --- FAQs ---
            faqQuestions.forEach(question => {
                question.addEventListener('click', () => {
                    const faqItem = question.closest('.faq-item');
                    faqItem.classList.toggle('active');
                });
            });

            // --- Contact Us Form ---
            contactInquiryForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                showSpinner(); // Show spinner on inquiry submission
                await new Promise(resolve => setTimeout(resolve, 500)); // Simulate network delay

                showSuccessMessage('Message Sent!', 'Your inquiry has been sent successfully. We will get back to you soon.');
                contactInquiryForm.reset();
                hideSpinner(); // Hide spinner after inquiry
            });

            // --- Theme Toggle ---

            const applyTheme = (theme) => {
                document.body.classList.remove('light-mode', 'dark-mode');
                document.body.classList.add(theme);
                localStorage.setItem('theme', theme);
                themeToggle.textContent = theme === 'dark-mode' ? '☀️' : '🌙';
            };

            themeToggle.addEventListener('click', () => {
                const currentTheme = document.body.classList.contains('dark-mode') ? 'dark-mode' : 'light-mode';
                const newTheme = currentTheme === 'dark-mode' ? 'light-mode' : 'dark-mode';
                applyTheme(newTheme);
            });

            const savedTheme = localStorage.getItem('theme') || 'light-mode';
            applyTheme(savedTheme);

            // --- Event Listeners ---

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = e.target.getAttribute('data-section');
                    showSection(sectionId);
                });
            });

            ticketForm.addEventListener('submit', handleSubmitTicket);
            myTicketsSearch.addEventListener('input', renderMyTickets);

            // Hamburger menu toggle
            hamburgerMenu.addEventListener('click', () => {
                navMenu.classList.toggle('active');
            });

            // Initial load
            showSection('home');
            // Set default customer name if not already saved
            if (!localStorage.getItem('lastCustomerName')) {
                document.getElementById('customer-name').value = 'John Doe';
            } else {
                document.getElementById('customer-name').value = lastCustomerName;
            }
        });
    </script>
</body>
</html>
